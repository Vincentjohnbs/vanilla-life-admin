<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>订单导出 - 香草生活后台管理</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .sidebar-collapsed {
            width: 4rem;
        }
        .main-content-expanded {
            margin-left: 4rem;
        }
        .export-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        .export-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-left-color: #10b981;
        }
        .template-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .template-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .template-card.selected {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .export-history-item {
            transition: all 0.2s ease;
        }
        .export-history-item:hover {
            background: #f9fafb;
        }
        .status-success {
            background: #d1fae5;
            color: #065f46;
        }
        .status-processing {
            background: #dbeafe;
            color: #1e40af;
        }
        .status-failed {
            background: #fee2e2;
            color: #991b1b;
        }
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        .field-checkbox {
            transition: all 0.2s ease;
        }
        .field-checkbox:checked {
            background: #10b981;
            border-color: #10b981;
        }
        .date-picker {
            position: relative;
        }
        .calendar-icon {
            pointer-events: none;
        }
    </style>

    <style>
        /* 隐藏侧边栏 */
        #sidebar, .sidebar-hidden { display: none !important; }
        /* 调整主内容区域 */
        .lg\:ml-64 { margin-left: 0 !important; }
        /* 隐藏侧边栏切换按钮 */
        #sidebarToggle, #sidebar-toggle { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 侧边栏 -->
    <div id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-white shadow-lg transition-all duration-300 z-50">
        <div class="p-6 border-b">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-leaf text-white text-lg"></i>
                </div>
                <div id="logo-text">
                    <h1 class="text-xl font-bold text-gray-800">香草生活</h1>
                    <p class="text-sm text-gray-500">后台管理系统</p>
                </div>
            </div>
        </div>
        
        <nav class="mt-6">
            <div class="px-4">
                <div class="space-y-2">
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-lg transition-colors">
                        <i class="fas fa-tachometer-alt w-5"></i>
                        <span class="nav-text">仪表盘</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-lg transition-colors">
                        <i class="fas fa-box w-5"></i>
                        <span class="nav-text">商品管理</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 bg-green-50 text-green-600 rounded-lg">
                        <i class="fas fa-shopping-cart w-5"></i>
                        <span class="nav-text">订单管理</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-lg transition-colors">
                        <i class="fas fa-users w-5"></i>
                        <span class="nav-text">用户管理</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-lg transition-colors">
                        <i class="fas fa-seedling w-5"></i>
                        <span class="nav-text">香草图鉴</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-lg transition-colors">
                        <i class="fas fa-comments w-5"></i>
                        <span class="nav-text">香草阳台</span>
                    </a>
                </div>
            </div>
        </nav>
    </div>

    <!-- 主内容区域 -->
    <div id="main-content" class="ml-64 transition-all duration-300">
        <!-- 顶部导航栏 -->
        <header class="bg-white shadow-sm border-b px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button id="sidebar-toggle" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                        <a href="#" class="hover:text-green-600">订单管理</a>
                        <i class="fas fa-chevron-right text-xs"></i>
                        <span class="text-green-600">订单导出</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell text-xl"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face" alt="用户头像" class="w-8 h-8 rounded-full">
                        <span class="text-sm text-gray-700">管理员</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 页面内容 -->
        <main class="p-6">
            <!-- 页面标题 -->
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">订单导出</h1>
                    <p class="text-gray-600 mt-1">导出订单数据，支持多种格式和自定义字段</p>
                </div>
                <div class="flex items-center space-x-3">
                    <button onclick="viewExportHistory()" class="px-4 py-2 text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                        <i class="fas fa-history mr-2"></i>导出历史
                    </button>
                    <button onclick="createTemplate()" class="px-4 py-2 text-purple-600 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                        <i class="fas fa-plus mr-2"></i>新建模板
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- 左侧：导出配置 -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- 导出模板选择 -->
                    <div class="export-card bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-file-alt text-green-600 mr-2"></i>选择导出模板
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="template-card border-2 border-gray-200 rounded-lg p-4 selected" onclick="selectTemplate('basic')">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">基础订单信息</h4>
                                    <i class="fas fa-check-circle text-green-600"></i>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">包含订单号、客户信息、商品信息、金额等基础字段</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-list mr-1"></i>
                                    <span>12个字段</span>
                                    <span class="mx-2">•</span>
                                    <i class="fas fa-clock mr-1"></i>
                                    <span>最近使用</span>
                                </div>
                            </div>
                            
                            <div class="template-card border-2 border-gray-200 rounded-lg p-4" onclick="selectTemplate('detailed')">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">详细订单报表</h4>
                                    <i class="fas fa-circle text-gray-300"></i>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">包含完整订单信息、物流信息、支付详情等</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-list mr-1"></i>
                                    <span>25个字段</span>
                                    <span class="mx-2">•</span>
                                    <i class="fas fa-star mr-1"></i>
                                    <span>推荐</span>
                                </div>
                            </div>
                            
                            <div class="template-card border-2 border-gray-200 rounded-lg p-4" onclick="selectTemplate('financial')">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">财务对账单</h4>
                                    <i class="fas fa-circle text-gray-300"></i>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">专用于财务对账，包含支付、退款、手续费等</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-list mr-1"></i>
                                    <span>18个字段</span>
                                    <span class="mx-2">•</span>
                                    <i class="fas fa-calculator mr-1"></i>
                                    <span>财务专用</span>
                                </div>
                            </div>
                            
                            <div class="template-card border-2 border-gray-200 rounded-lg p-4" onclick="selectTemplate('custom')">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-medium text-gray-900">自定义模板</h4>
                                    <i class="fas fa-circle text-gray-300"></i>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">自由选择需要导出的字段和格式</p>
                                <div class="flex items-center text-xs text-gray-500">
                                    <i class="fas fa-cog mr-1"></i>
                                    <span>自定义</span>
                                    <span class="mx-2">•</span>
                                    <i class="fas fa-wrench mr-1"></i>
                                    <span>灵活配置</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 筛选条件 -->
                    <div class="export-card bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-filter text-blue-600 mr-2"></i>筛选条件
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">时间范围</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="date-picker relative">
                                        <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <i class="fas fa-calendar-alt absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 calendar-icon"></i>
                                    </div>
                                    <div class="date-picker relative">
                                        <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <i class="fas fa-calendar-alt absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 calendar-icon"></i>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 mt-2">
                                    <button onclick="setDateRange('today')" class="px-3 py-1 text-xs text-blue-600 bg-blue-50 rounded hover:bg-blue-100 transition-colors">今天</button>
                                    <button onclick="setDateRange('week')" class="px-3 py-1 text-xs text-blue-600 bg-blue-50 rounded hover:bg-blue-100 transition-colors">本周</button>
                                    <button onclick="setDateRange('month')" class="px-3 py-1 text-xs text-blue-600 bg-blue-50 rounded hover:bg-blue-100 transition-colors">本月</button>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">订单状态</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">待付款</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">已付款</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">已发货</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">已完成</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">商品分类</label>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option>全部分类</option>
                                    <option>香草种子</option>
                                    <option>香草盆栽</option>
                                    <option>种植工具</option>
                                    <option>香草制品</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">客户类型</label>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option>全部客户</option>
                                    <option>新客户</option>
                                    <option>老客户</option>
                                    <option>VIP客户</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- 导出字段选择 -->
                    <div class="export-card bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-list-check text-purple-600 mr-2"></i>导出字段
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-3">基础信息</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">订单号</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">下单时间</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">订单状态</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">订单金额</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">支付方式</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-3">客户信息</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">客户姓名</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">联系电话</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">收货地址</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">客户等级</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">注册时间</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-3">商品信息</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">商品名称</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">商品SKU</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded" checked>
                                        <span class="ml-2 text-sm text-gray-700">商品数量</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">商品分类</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="field-checkbox rounded">
                                        <span class="ml-2 text-sm text-gray-700">单价</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between mt-4 pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <button onclick="selectAllFields()" class="px-3 py-1 text-sm text-blue-600 bg-blue-50 rounded hover:bg-blue-100 transition-colors">全选</button>
                                <button onclick="clearAllFields()" class="px-3 py-1 text-sm text-gray-600 bg-gray-50 rounded hover:bg-gray-100 transition-colors">清空</button>
                                <button onclick="resetFields()" class="px-3 py-1 text-sm text-purple-600 bg-purple-50 rounded hover:bg-purple-100 transition-colors">重置</button>
                            </div>
                            <span class="text-sm text-gray-500">已选择 <span id="selectedCount">8</span> 个字段</span>
                        </div>
                    </div>

                    <!-- 导出设置 -->
                    <div class="export-card bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-cog text-orange-600 mr-2"></i>导出设置
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">文件格式</label>
                                <div class="flex items-center space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="format" value="excel" class="text-green-600" checked>
                                        <span class="ml-2 text-sm text-gray-700">Excel (.xlsx)</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="format" value="csv" class="text-green-600">
                                        <span class="ml-2 text-sm text-gray-700">CSV (.csv)</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">文件名称</label>
                                <input type="text" value="订单导出_20240121" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">数据限制</label>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option>不限制</option>
                                    <option>最多1000条</option>
                                    <option>最多5000条</option>
                                    <option>最多10000条</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">导出方式</label>
                                <div class="flex items-center space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="method" value="download" class="text-green-600" checked>
                                        <span class="ml-2 text-sm text-gray-700">直接下载</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="method" value="email" class="text-green-600">
                                        <span class="ml-2 text-sm text-gray-700">邮件发送</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右侧：预览和操作 -->
                <div class="space-y-6">
                    <!-- 导出预览 -->
                    <div class="bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-eye text-indigo-600 mr-2"></i>导出预览
                        </h3>
                        <div class="space-y-4">
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">预计导出数据</span>
                                    <span class="text-lg font-bold text-green-600">1,234</span>
                                </div>
                                <p class="text-xs text-gray-500">条订单记录</p>
                            </div>
                            
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">文件大小</span>
                                    <span class="text-lg font-bold text-blue-600">~2.5MB</span>
                                </div>
                                <p class="text-xs text-gray-500">预估大小</p>
                            </div>
                            
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">导出字段</span>
                                    <span class="text-lg font-bold text-purple-600">8</span>
                                </div>
                                <p class="text-xs text-gray-500">个字段</p>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <button onclick="startExport()" class="w-full px-4 py-3 text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors font-medium">
                                <i class="fas fa-download mr-2"></i>开始导出
                            </button>
                        </div>
                    </div>

                    <!-- 导出进度 -->
                    <div id="exportProgress" class="bg-white rounded-lg shadow-sm border p-6 hidden">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-spinner fa-spin text-blue-600 mr-2"></i>导出进度
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-600">数据处理中...</span>
                                    <span class="text-sm font-medium text-blue-600">65%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="progress-bar bg-blue-600 h-2 rounded-full" style="width: 65%"></div>
                                </div>
                            </div>
                            
                            <div class="text-xs text-gray-500">
                                <p>已处理: 800/1234 条记录</p>
                                <p>预计剩余时间: 30秒</p>
                            </div>
                            
                            <button onclick="cancelExport()" class="w-full px-4 py-2 text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors">
                                <i class="fas fa-times mr-2"></i>取消导出
                            </button>
                        </div>
                    </div>

                    <!-- 快速操作 -->
                    <div class="bg-white rounded-lg shadow-sm border p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-bolt text-yellow-600 mr-2"></i>快速操作
                        </h3>
                        <div class="space-y-3">
                            <button onclick="exportToday()" class="w-full px-4 py-2 text-left text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                <i class="fas fa-calendar-day mr-2 text-blue-600"></i>
                                <span class="text-sm">导出今日订单</span>
                            </button>
                            <button onclick="exportWeek()" class="w-full px-4 py-2 text-left text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                <i class="fas fa-calendar-week mr-2 text-green-600"></i>
                                <span class="text-sm">导出本周订单</span>
                            </button>
                            <button onclick="exportMonth()" class="w-full px-4 py-2 text-left text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                <i class="fas fa-calendar-alt mr-2 text-purple-600"></i>
                                <span class="text-sm">导出本月订单</span>
                            </button>
                            <button onclick="exportPending()" class="w-full px-4 py-2 text-left text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                <i class="fas fa-clock mr-2 text-orange-600"></i>
                                <span class="text-sm">导出待处理订单</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 导出历史 -->
            <div class="mt-8">
                <div class="bg-white rounded-lg shadow-sm border">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-900">
                            <i class="fas fa-history text-gray-600 mr-2"></i>最近导出记录
                        </h3>
                    </div>
                    <div class="divide-y divide-gray-200">
                        <div class="export-history-item p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-file-excel text-green-600"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-medium text-gray-900">订单导出_20240121.xlsx</h4>
                                        <p class="text-xs text-gray-500">2024-01-21 16:30 • 1,234条记录 • 2.5MB</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="status-success px-2 py-1 text-xs rounded-full font-medium">成功</span>
                                    <button onclick="downloadFile('file1')" class="text-blue-600 hover:text-blue-800">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button onclick="deleteFile('file1')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="export-history-item p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-spinner fa-spin text-blue-600"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-medium text-gray-900">财务对账单_20240120.xlsx</h4>
                                        <p class="text-xs text-gray-500">2024-01-20 14:15 • 处理中...</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="status-processing px-2 py-1 text-xs rounded-full font-medium">处理中</span>
                                    <button onclick="cancelExportFile('file2')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="export-history-item p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-exclamation-triangle text-red-600"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-medium text-gray-900">详细订单报表_20240119.xlsx</h4>
                                        <p class="text-xs text-gray-500">2024-01-19 10:20 • 导出失败：数据量过大</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="status-failed px-2 py-1 text-xs rounded-full font-medium">失败</span>
                                    <button onclick="retryExport('file3')" class="text-green-600 hover:text-green-800">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                    <button onclick="deleteFile('file3')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // 侧边栏切换
        document.getElementById('sidebar-toggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const logoText = document.getElementById('logo-text');
            const navTexts = document.querySelectorAll('.nav-text');
            
            sidebar.classList.toggle('sidebar-collapsed');
            mainContent.classList.toggle('main-content-expanded');
            
            if (sidebar.classList.contains('sidebar-collapsed')) {
                logoText.style.display = 'none';
                navTexts.forEach(text => text.style.display = 'none');
            } else {
                logoText.style.display = 'block';
                navTexts.forEach(text => text.style.display = 'inline');
            }
        });

        // 选择模板
        function selectTemplate(templateType) {
            const cards = document.querySelectorAll('.template-card');
            cards.forEach(card => {
                card.classList.remove('selected');
                card.querySelector('i').className = 'fas fa-circle text-gray-300';
            });
            
            event.currentTarget.classList.add('selected');
            event.currentTarget.querySelector('i').className = 'fas fa-check-circle text-green-600';
            
            console.log('选择模板:', templateType);
        }

        // 设置日期范围
        function setDateRange(range) {
            const today = new Date();
            let startDate, endDate;
            
            switch(range) {
                case 'today':
                    startDate = endDate = today.toISOString().split('T')[0];
                    break;
                case 'week':
                    const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
                    startDate = weekStart.toISOString().split('T')[0];
                    endDate = new Date().toISOString().split('T')[0];
                    break;
                case 'month':
                    startDate = new Date(today.getFullYear(), today.getMonth(), 1).toISOString().split('T')[0];
                    endDate = new Date().toISOString().split('T')[0];
                    break;
            }
            
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs[0].value = startDate;
            dateInputs[1].value = endDate;
            
            console.log('设置日期范围:', range, startDate, endDate);
        }

        // 字段选择操作
        function selectAllFields() {
            const checkboxes = document.querySelectorAll('.field-checkbox');
            checkboxes.forEach(checkbox => checkbox.checked = true);
            updateSelectedCount();
        }

        function clearAllFields() {
            const checkboxes = document.querySelectorAll('.field-checkbox');
            checkboxes.forEach(checkbox => checkbox.checked = false);
            updateSelectedCount();
        }

        function resetFields() {
            // 重置为默认选择
            const checkboxes = document.querySelectorAll('.field-checkbox');
            checkboxes.forEach((checkbox, index) => {
                checkbox.checked = [0, 1, 2, 3, 5, 6, 9, 11].includes(index);
            });
            updateSelectedCount();
        }

        function updateSelectedCount() {
            const checkedBoxes = document.querySelectorAll('.field-checkbox:checked');
            document.getElementById('selectedCount').textContent = checkedBoxes.length;
        }

        // 开始导出
        function startExport() {
            const progressDiv = document.getElementById('exportProgress');
            progressDiv.classList.remove('hidden');
            
            // 模拟导出进度
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        progressDiv.classList.add('hidden');
                        alert('导出完成！文件已开始下载。');
                    }, 1000);
                }
                
                const progressBar = document.querySelector('.progress-bar');
                const progressText = progressDiv.querySelector('.text-blue-600');
                progressBar.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
            }, 500);
            
            console.log('开始导出订单数据');
        }

        // 取消导出
        function cancelExport() {
            document.getElementById('exportProgress').classList.add('hidden');
            alert('导出已取消');
            console.log('取消导出');
        }

        // 快速导出操作
        function exportToday() {
            setDateRange('today');
            setTimeout(startExport, 500);
        }

        function exportWeek() {
            setDateRange('week');
            setTimeout(startExport, 500);
        }

        function exportMonth() {
            setDateRange('month');
            setTimeout(startExport, 500);
        }

        function exportPending() {
            // 设置筛选条件为待处理订单
            const statusCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            statusCheckboxes.forEach((checkbox, index) => {
                checkbox.checked = index === 2; // 只选择待付款
            });
            setTimeout(startExport, 500);
        }

        // 文件操作
        function downloadFile(fileId) {
            alert(`下载文件: ${fileId}`);
            console.log('下载文件:', fileId);
        }

        function deleteFile(fileId) {
            if (confirm('确定要删除这个文件吗？')) {
                alert(`删除文件: ${fileId}`);
                console.log('删除文件:', fileId);
            }
        }

        function retryExport(fileId) {
            alert(`重新导出: ${fileId}`);
            console.log('重新导出:', fileId);
        }

        function cancelExportFile(fileId) {
            if (confirm('确定要取消这个导出任务吗？')) {
                alert(`取消导出: ${fileId}`);
                console.log('取消导出文件:', fileId);
            }
        }

        // 其他操作
        function viewExportHistory() {
            alert('查看完整导出历史');
            console.log('查看导出历史');
        }

        function createTemplate() {
            alert('创建新的导出模板');
            console.log('创建模板');
        }

        // 监听字段选择变化
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('field-checkbox')) {
                updateSelectedCount();
            }
        });

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateSelectedCount();
            console.log('订单导出页面加载完成');
        });
    </script>
</body>
</html>