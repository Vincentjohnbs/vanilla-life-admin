<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>付款记录 - 香草生活后台管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .metric-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .metric-card.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .metric-card.green {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .metric-card.orange {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-processing { background: #dbeafe; color: #1e40af; }
        .status-completed { background: #dcfce7; color: #166534; }
        .status-failed { background: #fed7d7; color: #991b1b; }
        .status-cancelled { background: #f3f4f6; color: #374151; }
        .filter-tag {
            transition: all 0.2s ease;
        }
        .filter-tag.active {
            background-color: #3b82f6;
            color: white;
        }
        .payment-item {
            border-left: 4px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        .payment-item.completed {
            border-left-color: #10b981;
        }
        .payment-item.pending {
            border-left-color: #f59e0b;
        }
        .payment-item.failed {
            border-left-color: #ef4444;
        }
        .payment-method-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        .bank-transfer { background: #dbeafe; color: #1e40af; }
        .alipay { background: #e0f2fe; color: #0277bd; }
        .wechat { background: #e8f5e8; color: #2e7d32; }
        .cash { background: #fff3e0; color: #f57c00; }
        .timeline-item {
            position: relative;
            padding-left: 2rem;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0.5rem;
            width: 0.5rem;
            height: 0.5rem;
            background: #3b82f6;
            border-radius: 50%;
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 0.75rem;
            top: 1rem;
            width: 1px;
            height: calc(100% - 1rem);
            background: #e5e7eb;
        }
        .timeline-item:last-child::after {
            display: none;
        }
    </style>

    <style>
        /* 隐藏侧边栏 */
        #sidebar, .sidebar-hidden { display: none !important; }
        /* 调整主内容区域 */
        .lg\:ml-64 { margin-left: 0 !important; }
        /* 隐藏侧边栏切换按钮 */
        #sidebarToggle, #sidebar-toggle { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 侧边栏 -->
    <div id="sidebar" class="fixed left-0 top-0 w-64 h-full bg-white shadow-lg transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out z-30">
        <div class="p-6 border-b border-gray-200">
            <h1 class="text-xl font-bold text-gray-800">香草生活</h1>
            <p class="text-sm text-gray-600 mt-1">后台管理系统</p>
        </div>
        
        <nav class="mt-6">
            <div class="px-4">
                <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">供应商管理</h3>
                <ul class="space-y-1">
                    <li><a href="71-供应商详情页.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-building mr-3"></i>供应商详情</a></li>
                    <li><a href="72-商品供应管理.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-boxes mr-3"></i>商品供应管理</a></li>
                    <li><a href="73-结算管理页.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-calculator mr-3"></i>结算管理</a></li>
                    <li><a href="74-合作协议.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-handshake mr-3"></i>合作协议</a></li>
                    <li><a href="75-资质管理.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-certificate mr-3"></i>资质管理</a></li>
                    <li><a href="76-评级管理.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-star mr-3"></i>评级管理</a></li>
                    <li><a href="77-采购订单.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-shopping-cart mr-3"></i>采购订单</a></li>
                    <li><a href="78-对账管理.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-balance-scale mr-3"></i>对账管理</a></li>
                    <li><a href="79-付款记录.html" class="flex items-center px-3 py-2 text-white bg-green-600 rounded-lg"><i class="fas fa-credit-card mr-3"></i>付款记录</a></li>
                    <li><a href="80-供应商统计.html" class="flex items-center px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"><i class="fas fa-chart-bar mr-3"></i>供应商统计</a></li>
                </ul>
            </div>
        </nav>
    </div>

    <!-- 主内容区域 -->
    <div class="lg:ml-64">
        <!-- 顶部导航栏 -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center">
                    <button id="sidebarToggle" class="lg:hidden p-2 rounded-md text-gray-600 hover:bg-gray-100">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="ml-4">
                        <h2 class="text-xl font-semibold text-gray-800">付款记录</h2>
                        <p class="text-sm text-gray-600">管理供应商付款记录和财务流水</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="createPayment" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                        <i class="fas fa-plus mr-2"></i>新建付款
                    </button>
                    <button id="batchPayment" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                        <i class="fas fa-money-bill-wave mr-2"></i>批量付款
                    </button>
                    <button id="exportPayments" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-file-export mr-2"></i>导出记录
                    </button>
                    <div class="flex items-center space-x-2">
                        <img src="https://via.placeholder.com/32" alt="用户头像" class="w-8 h-8 rounded-full">
                        <span class="text-sm font-medium text-gray-700">管理员</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 页面内容 -->
        <main class="p-6">
            <!-- 统计卡片 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="metric-card rounded-xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white/80 text-sm">本月付款总额</p>
                            <p class="text-2xl font-bold mt-1">¥186.8万</p>
                            <p class="text-white/80 text-sm mt-1">
                                <i class="fas fa-arrow-up mr-1"></i>+12% 环比增长
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-money-bill-wave text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="metric-card blue rounded-xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white/80 text-sm">待付款金额</p>
                            <p class="text-2xl font-bold mt-1">¥28.5万</p>
                            <p class="text-white/80 text-sm mt-1">
                                <i class="fas fa-clock mr-1"></i>15 笔待处理
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-hourglass-half text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="metric-card green rounded-xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white/80 text-sm">付款成功率</p>
                            <p class="text-2xl font-bold mt-1">99.2%</p>
                            <p class="text-white/80 text-sm mt-1">
                                <i class="fas fa-check-circle mr-1"></i>高成功率
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="metric-card orange rounded-xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white/80 text-sm">平均付款周期</p>
                            <p class="text-2xl font-bold mt-1">3.2天</p>
                            <p class="text-white/80 text-sm mt-1">
                                <i class="fas fa-arrow-down mr-1"></i>-0.5天 优化
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-calendar-alt text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 付款趋势图表 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">付款趋势分析</h3>
                    <canvas id="paymentTrendChart" width="400" height="200"></canvas>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">付款方式分布</h3>
                    <canvas id="paymentMethodChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- 筛选和搜索 -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
                    <div class="flex flex-wrap items-center gap-4">
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="搜索付款单号、供应商..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-64">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                        
                        <select id="supplierFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">全部供应商</option>
                            <option value="绿野香草农场">绿野香草农场</option>
                            <option value="天然香草园">天然香草园</option>
                            <option value="有机香草基地">有机香草基地</option>
                        </select>
                        
                        <select id="methodFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">全部付款方式</option>
                            <option value="bank_transfer">银行转账</option>
                            <option value="alipay">支付宝</option>
                            <option value="wechat">微信支付</option>
                            <option value="cash">现金</option>
                        </select>
                        
                        <input type="date" id="dateFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <span class="text-sm text-gray-600">状态筛选：</span>
                        <button class="filter-tag active px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-700" data-status="all">全部</button>
                        <button class="filter-tag px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-700" data-status="pending">待付款</button>
                        <button class="filter-tag px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-700" data-status="processing">处理中</button>
                        <button class="filter-tag px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-700" data-status="completed">已完成</button>
                        <button class="filter-tag px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-700" data-status="failed">失败</button>
                    </div>
                </div>
            </div>

            <!-- 付款记录列表 -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-100">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">付款记录列表</h3>
                        <div class="flex items-center space-x-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="selectAll" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-600">全选</span>
                            </label>
                            <div class="relative">
                                <button id="batchActions" class="px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
                                    <i class="fas fa-ellipsis-v mr-1"></i>批量操作
                                </button>
                                <div id="batchMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10">
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">批量确认</a>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">批量导出</a>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">批量取消</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="divide-y divide-gray-200" id="paymentList">
                    <!-- 付款记录数据将通过JavaScript动态生成 -->
                </div>
                
                <!-- 分页 -->
                <div class="px-6 py-4 border-t border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="text-sm text-gray-700">
                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">10</span> 条，共 <span class="font-medium">156</span> 条记录
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="px-3 py-2 text-sm text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50" disabled>
                                上一页
                            </button>
                            <button class="px-3 py-2 text-sm text-white bg-blue-500 border border-blue-500 rounded-lg">1</button>
                            <button class="px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">2</button>
                            <button class="px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">3</button>
                            <span class="px-3 py-2 text-sm text-gray-500">...</span>
                            <button class="px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">16</button>
                            <button class="px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                                下一页
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 付款详情模态框 -->
    <div id="paymentDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">付款详情</h3>
            </div>
            <div class="p-6">
                <div id="paymentDetailContent">
                    <!-- 付款详情内容将通过JavaScript动态生成 -->
                </div>
            </div>
            <div class="p-6 border-t border-gray-200 flex justify-end space-x-4">
                <button id="closePaymentDetail" class="px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                    关闭
                </button>
                <button id="printPayment" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                    <i class="fas fa-print mr-2"></i>打印凭证
                </button>
            </div>
        </div>
    </div>

    <!-- 新建付款模态框 -->
    <div id="createPaymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">新建付款</h3>
            </div>
            <div class="p-6">
                <form class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">供应商 *</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">请选择供应商</option>
                                <option value="绿野香草农场">绿野香草农场</option>
                                <option value="天然香草园">天然香草园</option>
                                <option value="有机香草基地">有机香草基地</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">付款金额 *</label>
                            <input type="number" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入付款金额">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">付款方式 *</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="bank_transfer">银行转账</option>
                                <option value="alipay">支付宝</option>
                                <option value="wechat">微信支付</option>
                                <option value="cash">现金</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">付款日期 *</label>
                            <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">关联订单</label>
                        <div class="border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto">
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm">PO202406001 - ¥10,900.00</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm">PO202406002 - ¥7,800.00</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm">PO202406003 - ¥10,740.00</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">付款说明</label>
                        <textarea rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入付款说明和备注"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">付款凭证</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                            <p class="text-sm text-gray-600">点击上传或拖拽文件到此处</p>
                            <p class="text-xs text-gray-500 mt-1">支持 JPG、PNG、PDF 格式，最大 10MB</p>
                            <input type="file" class="hidden" accept=".jpg,.jpeg,.png,.pdf">
                        </div>
                    </div>
                </form>
            </div>
            <div class="p-6 border-t border-gray-200 flex justify-end space-x-4">
                <button id="cancelCreatePayment" class="px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                    取消
                </button>
                <button id="submitPayment" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                    创建付款
                </button>
            </div>
        </div>
    </div>

    <script>
        // 模拟付款数据
        const paymentData = [
            {
                id: 'PAY202406001',
                supplier: '绿野香草农场',
                amount: 125800.00,
                method: 'bank_transfer',
                status: 'completed',
                paymentDate: '2024-06-15',
                createTime: '2024-06-15 10:30',
                orderIds: ['PO202406001', 'PO202406002'],
                description: '6月份采购款项结算',
                voucher: 'voucher_001.pdf',
                timeline: [
                    { time: '2024-06-15 10:30', event: '创建付款申请', status: 'completed' },
                    { time: '2024-06-15 11:15', event: '财务审核通过', status: 'completed' },
                    { time: '2024-06-15 14:20', event: '银行转账成功', status: 'completed' },
                    { time: '2024-06-15 14:25', event: '供应商确认收款', status: 'completed' }
                ]
            },
            {
                id: 'PAY202406002',
                supplier: '天然香草园',
                amount: 89600.00,
                method: 'alipay',
                status: 'processing',
                paymentDate: '2024-06-14',
                createTime: '2024-06-14 14:20',
                orderIds: ['PO202406003', 'PO202406004'],
                description: '香草种子采购付款',
                voucher: null,
                timeline: [
                    { time: '2024-06-14 14:20', event: '创建付款申请', status: 'completed' },
                    { time: '2024-06-14 15:30', event: '财务审核通过', status: 'completed' },
                    { time: '2024-06-14 16:00', event: '支付宝转账中', status: 'processing' }
                ]
            },
            {
                id: 'PAY202406003',
                supplier: '有机香草基地',
                amount: 156200.00,
                method: 'bank_transfer',
                status: 'completed',
                paymentDate: '2024-06-01',
                createTime: '2024-06-01 09:15',
                orderIds: ['PO202405001', 'PO202405002', 'PO202405003'],
                description: '5月份结算款项',
                voucher: 'voucher_003.pdf',
                timeline: [
                    { time: '2024-06-01 09:15', event: '创建付款申请', status: 'completed' },
                    { time: '2024-06-01 10:00', event: '财务审核通过', status: 'completed' },
                    { time: '2024-06-01 11:30', event: '银行转账成功', status: 'completed' },
                    { time: '2024-06-01 12:00', event: '供应商确认收款', status: 'completed' }
                ]
            },
            {
                id: 'PAY202406004',
                supplier: '绿色包装材料公司',
                amount: 28400.00,
                method: 'wechat',
                status: 'failed',
                paymentDate: '2024-06-12',
                createTime: '2024-06-12 16:45',
                orderIds: ['PO202406010'],
                description: '包装材料采购款',
                voucher: null,
                timeline: [
                    { time: '2024-06-12 16:45', event: '创建付款申请', status: 'completed' },
                    { time: '2024-06-12 17:00', event: '财务审核通过', status: 'completed' },
                    { time: '2024-06-12 17:30', event: '微信支付失败', status: 'failed' }
                ]
            },
            {
                id: 'PAY202406005',
                supplier: '快运物流服务',
                amount: 12000.00,
                method: 'cash',
                status: 'pending',
                paymentDate: '2024-06-10',
                createTime: '2024-06-10 11:20',
                orderIds: ['PO202406011'],
                description: '物流服务费用',
                voucher: null,
                timeline: [
                    { time: '2024-06-10 11:20', event: '创建付款申请', status: 'completed' },
                    { time: '2024-06-10 12:00', event: '等待财务审核', status: 'pending' }
                ]
            }
        ];

        let filteredData = [...paymentData];
        let currentPage = 1;
        const itemsPerPage = 10;

        // 侧边栏切换
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('-translate-x-full');
        });

        // 状态筛选标签
        function initStatusFilters() {
            const filterTags = document.querySelectorAll('.filter-tag');
            filterTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    // 移除所有active类
                    filterTags.forEach(t => t.classList.remove('active'));
                    // 添加active类到当前标签
                    this.classList.add('active');
                    
                    const status = this.getAttribute('data-status');
                    filterPayments(status);
                });
            });
        }

        // 筛选付款记录
        function filterPayments(status = 'all') {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const supplierFilter = document.getElementById('supplierFilter').value;
            const methodFilter = document.getElementById('methodFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;

            filteredData = paymentData.filter(item => {
                const matchesSearch = item.id.toLowerCase().includes(searchTerm) || 
                                    item.supplier.toLowerCase().includes(searchTerm);
                const matchesSupplier = !supplierFilter || item.supplier === supplierFilter;
                const matchesMethod = !methodFilter || item.method === methodFilter;
                const matchesStatus = status === 'all' || item.status === status;
                const matchesDate = !dateFilter || item.paymentDate.includes(dateFilter);

                return matchesSearch && matchesSupplier && matchesMethod && matchesStatus && matchesDate;
            });

            renderPaymentList();
            updateTotalCount();
        }

        // 渲染付款记录列表
        function renderPaymentList() {
            const container = document.getElementById('paymentList');
            container.innerHTML = '';

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);

            pageData.forEach(item => {
                const div = document.createElement('div');
                div.className = `payment-item p-6 ${item.status}`;
                
                // 状态样式
                const statusClass = `status-${item.status}`;
                const statusText = {
                    'pending': '待付款',
                    'processing': '处理中',
                    'completed': '已完成',
                    'failed': '失败',
                    'cancelled': '已取消'
                }[item.status];
                
                // 付款方式图标和文本
                const methodInfo = {
                    'bank_transfer': { icon: 'fas fa-university', text: '银行转账', class: 'bank-transfer' },
                    'alipay': { icon: 'fab fa-alipay', text: '支付宝', class: 'alipay' },
                    'wechat': { icon: 'fab fa-weixin', text: '微信支付', class: 'wechat' },
                    'cash': { icon: 'fas fa-money-bill', text: '现金', class: 'cash' }
                }[item.method];

                div.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <div class="payment-method-icon ${methodInfo.class}">
                                <i class="${methodInfo.icon}"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center space-x-3 mb-2">
                                    <h4 class="text-lg font-semibold text-gray-900">${item.id}</h4>
                                    <span class="status-badge ${statusClass}">${statusText}</span>
                                    <span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded">${methodInfo.text}</span>
                                </div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                                    <div>
                                        <span class="text-gray-600">供应商：</span>
                                        <span class="font-medium text-gray-900">${item.supplier}</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">付款日期：</span>
                                        <span class="font-medium text-gray-900">${item.paymentDate}</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">关联订单：</span>
                                        <span class="font-medium text-gray-900">${item.orderIds.length} 个</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">创建时间：</span>
                                        <span class="font-medium text-gray-900">${item.createTime}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-6">
                            <div class="text-right">
                                <div class="text-sm text-gray-600">付款金额</div>
                                <div class="text-2xl font-bold text-gray-900">¥${item.amount.toLocaleString()}</div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button class="text-blue-600 hover:text-blue-800 text-sm" onclick="viewPaymentDetail('${item.id}')">
                                    <i class="fas fa-eye mr-1"></i>查看
                                </button>
                                ${item.status === 'pending' ? `
                                    <button class="text-green-600 hover:text-green-800 text-sm" onclick="processPayment('${item.id}')">
                                        <i class="fas fa-check mr-1"></i>处理
                                    </button>
                                ` : ''}
                                ${item.status === 'failed' ? `
                                    <button class="text-orange-600 hover:text-orange-800 text-sm" onclick="retryPayment('${item.id}')">
                                        <i class="fas fa-redo mr-1"></i>重试
                                    </button>
                                ` : ''}
                                <button class="text-red-600 hover:text-red-800 text-sm" onclick="deletePayment('${item.id}')">
                                    <i class="fas fa-trash mr-1"></i>删除
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <div class="flex items-center justify-between text-sm">
                            <div class="text-gray-600">
                                <i class="fas fa-sticky-note mr-1"></i>${item.description}
                            </div>
                            <div class="flex items-center space-x-4">
                                <span class="text-gray-500">
                                    <i class="fas fa-link mr-1"></i>关联订单：${item.orderIds.join(', ')}
                                </span>
                                ${item.voucher ? `
                                    <span class="text-green-600">
                                        <i class="fas fa-file-alt mr-1"></i>有凭证
                                    </span>
                                ` : `
                                    <span class="text-gray-400">
                                        <i class="fas fa-file-alt mr-1"></i>无凭证
                                    </span>
                                `}
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        // 更新总数显示
        function updateTotalCount() {
            console.log(`当前显示 ${filteredData.length} 条付款记录`);
        }

        // 查看付款详情
        function viewPaymentDetail(paymentId) {
            const item = paymentData.find(p => p.id === paymentId);
            if (!item) return;

            const methodInfo = {
                'bank_transfer': { icon: 'fas fa-university', text: '银行转账' },
                'alipay': { icon: 'fab fa-alipay', text: '支付宝' },
                'wechat': { icon: 'fab fa-weixin', text: '微信支付' },
                'cash': { icon: 'fas fa-money-bill', text: '现金' }
            }[item.method];

            const content = document.getElementById('paymentDetailContent');
            content.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">付款信息</h4>
                        <div class="bg-gray-50 rounded-lg p-6 mb-6">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <span class="text-sm text-gray-600">付款单号：</span>
                                    <span class="font-medium text-gray-900">${item.id}</span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-600">供应商：</span>
                                    <span class="font-medium text-gray-900">${item.supplier}</span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-600">付款金额：</span>
                                    <span class="font-medium text-gray-900">¥${item.amount.toLocaleString()}</span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-600">付款方式：</span>
                                    <span class="font-medium text-gray-900">
                                        <i class="${methodInfo.icon} mr-1"></i>${methodInfo.text}
                                    </span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-600">付款日期：</span>
                                    <span class="font-medium text-gray-900">${item.paymentDate}</span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-600">状态：</span>
                                    <span class="status-badge status-${item.status}">${{
                                        'pending': '待付款',
                                        'processing': '处理中',
                                        'completed': '已完成',
                                        'failed': '失败',
                                        'cancelled': '已取消'
                                    }[item.status]}</span>
                                </div>
                            </div>
                        </div>
                        
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">关联订单</h4>
                        <div class="bg-white border border-gray-200 rounded-lg overflow-hidden mb-6">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">订单号</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">订单金额</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">状态</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    ${item.orderIds.map(orderId => `
                                        <tr>
                                            <td class="px-4 py-3 text-sm text-gray-900">${orderId}</td>
                                            <td class="px-4 py-3 text-sm text-gray-900">¥${(Math.random() * 50000 + 10000).toFixed(2)}</td>
                                            <td class="px-4 py-3">
                                                <span class="status-badge status-completed">已完成</span>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">付款说明</h4>
                        <div class="bg-gray-50 rounded-lg p-4 mb-6">
                            <p class="text-gray-700">${item.description}</p>
                        </div>
                        
                        ${item.voucher ? `
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">付款凭证</h4>
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-file-pdf text-red-500 text-xl"></i>
                                    <div>
                                        <div class="font-medium text-gray-900">${item.voucher}</div>
                                        <div class="text-sm text-gray-500">PDF文件 • 2.3MB</div>
                                    </div>
                                    <button class="text-blue-600 hover:text-blue-800 text-sm">
                                        <i class="fas fa-download mr-1"></i>下载
                                    </button>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">付款进度</h4>
                        <div class="space-y-4">
                            ${item.timeline.map(step => `
                                <div class="timeline-item">
                                    <div class="flex items-center justify-between mb-1">
                                        <span class="text-sm font-medium text-gray-900">${step.event}</span>
                                        <span class="status-badge status-${step.status}">${{
                                            'completed': '已完成',
                                            'processing': '进行中',
                                            'pending': '等待中',
                                            'failed': '失败'
                                        }[step.status]}</span>
                                    </div>
                                    <div class="text-xs text-gray-500">${step.time}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('paymentDetailModal').classList.remove('hidden');
            document.getElementById('paymentDetailModal').classList.add('flex');
        }

        // 处理付款
        function processPayment(paymentId) {
            alert(`处理付款：${paymentId}`);
        }

        // 重试付款
        function retryPayment(paymentId) {
            alert(`重试付款：${paymentId}`);
        }

        // 删除付款
        function deletePayment(paymentId) {
            if (confirm('确定要删除这条付款记录吗？')) {
                alert(`删除付款：${paymentId}`);
            }
        }

        // 搜索功能
        document.getElementById('searchInput').addEventListener('input', function() {
            filterPayments(document.querySelector('.filter-tag.active').getAttribute('data-status'));
        });

        // 筛选器变化
        document.getElementById('supplierFilter').addEventListener('change', function() {
            filterPayments(document.querySelector('.filter-tag.active').getAttribute('data-status'));
        });

        document.getElementById('methodFilter').addEventListener('change', function() {
            filterPayments(document.querySelector('.filter-tag.active').getAttribute('data-status'));
        });

        document.getElementById('dateFilter').addEventListener('change', function() {
            filterPayments(document.querySelector('.filter-tag.active').getAttribute('data-status'));
        });

        // 全选功能
        document.getElementById('selectAll').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('#paymentList input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
        });

        // 批量操作菜单
        document.getElementById('batchActions').addEventListener('click', function() {
            const menu = document.getElementById('batchMenu');
            menu.classList.toggle('hidden');
        });

        // 新建付款模态框
        document.getElementById('createPayment').addEventListener('click', function() {
            document.getElementById('createPaymentModal').classList.remove('hidden');
            document.getElementById('createPaymentModal').classList.add('flex');
        });

        document.getElementById('cancelCreatePayment').addEventListener('click', function() {
            document.getElementById('createPaymentModal').classList.add('hidden');
            document.getElementById('createPaymentModal').classList.remove('flex');
        });

        document.getElementById('submitPayment').addEventListener('click', function() {
            alert('付款已创建');
            document.getElementById('createPaymentModal').classList.add('hidden');
            document.getElementById('createPaymentModal').classList.remove('flex');
        });

        // 关闭付款详情模态框
        document.getElementById('closePaymentDetail').addEventListener('click', function() {
            document.getElementById('paymentDetailModal').classList.add('hidden');
            document.getElementById('paymentDetailModal').classList.remove('flex');
        });

        document.getElementById('printPayment').addEventListener('click', function() {
            alert('打印付款凭证');
        });

        // 批量付款
        document.getElementById('batchPayment').addEventListener('click', function() {
            alert('批量付款功能');
        });

        // 导出记录
        document.getElementById('exportPayments').addEventListener('click', function() {
            alert('导出付款记录');
        });

        // 初始化图表
        function initCharts() {
            // 付款趋势图表
            const trendCtx = document.getElementById('paymentTrendChart').getContext('2d');
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    datasets: [{
                        label: '付款金额(万元)',
                        data: [120, 135, 148, 162, 175, 187],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // 付款方式分布图表
            const methodCtx = document.getElementById('paymentMethodChart').getContext('2d');
            new Chart(methodCtx, {
                type: 'doughnut',
                data: {
                    labels: ['银行转账', '支付宝', '微信支付', '现金'],
                    datasets: [{
                        data: [65, 20, 12, 3],
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#ef4444'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // 页面初始化
        document.addEventListener('DOMContentLoaded', function() {
            initStatusFilters();
            renderPaymentList();
            updateTotalCount();
            initCharts();
        });
    </script>
</body>
</html>