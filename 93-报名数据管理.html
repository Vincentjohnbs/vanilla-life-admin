<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>报名数据管理 - 香草生活后台管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .sidebar-item:hover { background-color: #f3f4f6; }
        .sidebar-item.active { background-color: #10b981; color: white; }
        .tab-item { transition: all 0.3s ease; }
        .tab-item.active { border-bottom-color: #10b981; color: #10b981; }
        .data-card { transition: all 0.3s ease; }
        .data-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .filter-tag { transition: all 0.3s ease; }
        .filter-tag.active { background-color: #10b981; color: white; }
        .status-badge { font-size: 0.75rem; }
        .table-row:hover { background-color: #f9fafb; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 侧边栏 -->
    <div class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg z-50">
        <div class="flex items-center justify-center h-16 border-b border-gray-200">
            <h1 class="text-xl font-bold text-gray-800">香草生活管理</h1>
        </div>
        <nav class="mt-8">
            <div class="px-4 space-y-2">
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-tachometer-alt mr-3"></i>仪表盘
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-box mr-3"></i>商品管理
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-shopping-cart mr-3"></i>订单管理
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-users mr-3"></i>用户管理
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-bullhorn mr-3"></i>营销活动
                </a>
                <a href="#" class="sidebar-item active flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-calendar-plus mr-3"></i>活动报名
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-truck mr-3"></i>供应商管理
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-leaf mr-3"></i>香草图鉴
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-seedling mr-3"></i>香草阳台
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-images mr-3"></i>Banner管理
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-gray-700 rounded-lg">
                    <i class="fas fa-cog mr-3"></i>系统设置
                </a>
            </div>
        </nav>
    </div>

    <!-- 主内容区域 -->
    <div class="ml-64 flex-1">
        <!-- 顶部导航栏 -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center space-x-4">
                    <button id="sidebar-toggle" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <a href="#" class="text-gray-500 hover:text-gray-700">活动报名</a>
                        <i class="fas fa-chevron-right text-gray-400 text-sm"></i>
                        <span class="text-gray-900 font-medium">报名数据管理</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="export-data-btn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                        <i class="fas fa-download mr-2"></i>导出数据
                    </button>
                    <button id="batch-action-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i class="fas fa-tasks mr-2"></i>批量操作
                    </button>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <img src="https://via.placeholder.com/32" alt="用户头像" class="w-8 h-8 rounded-full">
                        <span class="text-sm text-gray-700">管理员</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 页面头部 -->
        <div class="p-6">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-xl mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold mb-2">报名数据管理</h1>
                        <p class="text-blue-100">管理活动报名数据，查看报名详情，处理报名审核</p>
                    </div>
                    <div class="flex items-center space-x-6">
                        <div class="text-center">
                            <div class="text-2xl font-bold">1,234</div>
                            <div class="text-sm text-blue-100">总报名数</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold">89</div>
                            <div class="text-sm text-blue-100">今日新增</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold">156</div>
                            <div class="text-sm text-blue-100">待审核</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 统计卡片 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="data-card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">总报名数</p>
                            <p class="text-2xl font-bold text-gray-900">1,234</p>
                            <p class="text-sm text-green-600 mt-1">
                                <i class="fas fa-arrow-up mr-1"></i>+12.5%
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-blue-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="data-card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">通过审核</p>
                            <p class="text-2xl font-bold text-gray-900">1,078</p>
                            <p class="text-sm text-green-600 mt-1">
                                <i class="fas fa-arrow-up mr-1"></i>+8.3%
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="data-card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">待审核</p>
                            <p class="text-2xl font-bold text-gray-900">156</p>
                            <p class="text-sm text-orange-600 mt-1">
                                <i class="fas fa-clock mr-1"></i>需处理
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-hourglass-half text-orange-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="data-card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">转化率</p>
                            <p class="text-2xl font-bold text-gray-900">87.3%</p>
                            <p class="text-sm text-green-600 mt-1">
                                <i class="fas fa-arrow-up mr-1"></i>+2.1%
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 筛选和操作栏 -->
            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input type="text" id="search-input" placeholder="搜索报名者姓名、手机号..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-64">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                        
                        <select id="activity-filter" class="px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">全部活动</option>
                            <option value="workshop">香草种植工作坊</option>
                            <option value="cooking">香草料理课程</option>
                            <option value="garden">香草花园参观</option>
                        </select>
                        
                        <select id="status-filter" class="px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">全部状态</option>
                            <option value="pending">待审核</option>
                            <option value="approved">已通过</option>
                            <option value="rejected">已拒绝</option>
                            <option value="cancelled">已取消</option>
                        </select>
                        
                        <input type="date" id="date-filter" class="px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <button id="reset-filter" class="px-3 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
                            <i class="fas fa-undo mr-1"></i>重置
                        </button>
                        <button id="refresh-data" class="px-3 py-2 text-blue-600 border border-blue-300 rounded-lg hover:bg-blue-50">
                            <i class="fas fa-sync-alt mr-1"></i>刷新
                        </button>
                    </div>
                </div>
            </div>

            <!-- 标签页导航 -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="border-b border-gray-200">
                    <nav class="flex space-x-8 px-6">
                        <button class="tab-item py-4 px-1 border-b-2 border-transparent font-medium text-sm active" data-tab="all">
                            全部报名 (1,234)
                        </button>
                        <button class="tab-item py-4 px-1 border-b-2 border-transparent font-medium text-sm" data-tab="pending">
                            待审核 (156)
                        </button>
                        <button class="tab-item py-4 px-1 border-b-2 border-transparent font-medium text-sm" data-tab="approved">
                            已通过 (1,078)
                        </button>
                        <button class="tab-item py-4 px-1 border-b-2 border-transparent font-medium text-sm" data-tab="rejected">
                            已拒绝 (45)
                        </button>
                        <button class="tab-item py-4 px-1 border-b-2 border-transparent font-medium text-sm" data-tab="cancelled">
                            已取消 (23)
                        </button>
                    </nav>
                </div>

                <!-- 报名数据表格 -->
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="text-left py-3 px-4">
                                        <input type="checkbox" id="select-all" class="rounded">
                                    </th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">报名者信息</th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">活动信息</th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">报名时间</th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">状态</th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">审核信息</th>
                                    <th class="text-left py-3 px-4 font-medium text-gray-700">操作</th>
                                </tr>
                            </thead>
                            <tbody id="registration-table">
                                <!-- 动态生成的报名数据 -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 分页 -->
                    <div class="flex items-center justify-between mt-6">
                        <div class="text-sm text-gray-600">
                            显示 1-20 条，共 1,234 条记录
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50">上一页</button>
                            <button class="px-3 py-1 bg-blue-600 text-white rounded text-sm">1</button>
                            <button class="px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50">2</button>
                            <button class="px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50">3</button>
                            <span class="px-2 text-gray-500">...</span>
                            <button class="px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50">10</button>
                            <button class="px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50">下一页</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 报名详情模态框 -->
    <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold">报名详情</h3>
                        <button id="close-detail-modal" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div id="detail-content">
                        <!-- 动态内容 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 审核模态框 -->
    <div id="review-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold">审核报名</h3>
                        <button id="close-review-modal" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">审核结果</label>
                            <select id="review-result" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="approved">通过</option>
                                <option value="rejected">拒绝</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">审核备注</label>
                            <textarea id="review-note" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="请输入审核备注..."></textarea>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="cancel-review" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
                            取消
                        </button>
                        <button id="confirm-review" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                            确定
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 批量操作模态框 -->
    <div id="batch-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold">批量操作</h3>
                        <button id="close-batch-modal" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">操作类型</label>
                            <select id="batch-action" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="approve">批量通过</option>
                                <option value="reject">批量拒绝</option>
                                <option value="delete">批量删除</option>
                                <option value="export">批量导出</option>
                            </select>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                            <div class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
                                <span class="text-sm text-yellow-800">已选择 <span id="selected-count">0</span> 条记录</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="cancel-batch" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
                            取消
                        </button>
                        <button id="confirm-batch" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                            执行操作
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'all';
        let registrations = [];
        let selectedItems = new Set();

        // 模拟报名数据
        const mockRegistrations = [
            {
                id: 1,
                name: '张小明',
                phone: '138****5678',
                email: 'zhangxm@example.com',
                activity: '香草种植工作坊',
                activityDate: '2024-02-15',
                registrationDate: '2024-01-20 14:30',
                status: 'pending',
                reviewer: '',
                reviewDate: '',
                reviewNote: '',
                formData: {
                    age: 28,
                    occupation: '设计师',
                    experience: '初学者',
                    expectations: '希望学习基础的香草种植技巧'
                }
            },
            {
                id: 2,
                name: '李小红',
                phone: '139****1234',
                email: 'lixh@example.com',
                activity: '香草料理课程',
                activityDate: '2024-02-18',
                registrationDate: '2024-01-18 09:15',
                status: 'approved',
                reviewer: '管理员A',
                reviewDate: '2024-01-19 10:00',
                reviewNote: '资料完整，通过审核',
                formData: {
                    age: 32,
                    occupation: '厨师',
                    experience: '有经验',
                    expectations: '学习更多香草在料理中的应用'
                }
            },
            {
                id: 3,
                name: '王大华',
                phone: '137****9876',
                email: 'wangdh@example.com',
                activity: '香草花园参观',
                activityDate: '2024-02-20',
                registrationDate: '2024-01-22 16:45',
                status: 'rejected',
                reviewer: '管理员B',
                reviewDate: '2024-01-23 11:30',
                reviewNote: '年龄不符合活动要求',
                formData: {
                    age: 16,
                    occupation: '学生',
                    experience: '无经验',
                    expectations: '想了解香草植物'
                }
            }
        ];

        // 初始化数据
        registrations = [...mockRegistrations];

        // 标签页切换
        document.querySelectorAll('.tab-item').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                currentTab = this.getAttribute('data-tab');
                renderRegistrationTable();
            });
        });

        // 渲染报名表格
        function renderRegistrationTable() {
            const tbody = document.getElementById('registration-table');
            let filteredData = registrations;

            // 根据标签页筛选
            if (currentTab !== 'all') {
                filteredData = registrations.filter(reg => reg.status === currentTab);
            }

            // 应用其他筛选条件
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const activityFilter = document.getElementById('activity-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            const dateFilter = document.getElementById('date-filter').value;

            if (searchTerm) {
                filteredData = filteredData.filter(reg => 
                    reg.name.toLowerCase().includes(searchTerm) || 
                    reg.phone.includes(searchTerm) ||
                    reg.email.toLowerCase().includes(searchTerm)
                );
            }

            if (activityFilter) {
                filteredData = filteredData.filter(reg => reg.activity.includes(activityFilter));
            }

            if (statusFilter) {
                filteredData = filteredData.filter(reg => reg.status === statusFilter);
            }

            if (dateFilter) {
                filteredData = filteredData.filter(reg => reg.registrationDate.startsWith(dateFilter));
            }

            tbody.innerHTML = filteredData.map(reg => `
                <tr class="table-row border-b border-gray-100">
                    <td class="py-4 px-4">
                        <input type="checkbox" class="item-checkbox rounded" data-id="${reg.id}">
                    </td>
                    <td class="py-4 px-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-blue-600"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-900">${reg.name}</div>
                                <div class="text-sm text-gray-500">${reg.phone}</div>
                                <div class="text-sm text-gray-500">${reg.email}</div>
                            </div>
                        </div>
                    </td>
                    <td class="py-4 px-4">
                        <div>
                            <div class="font-medium text-gray-900">${reg.activity}</div>
                            <div class="text-sm text-gray-500">活动时间：${reg.activityDate}</div>
                        </div>
                    </td>
                    <td class="py-4 px-4">
                        <div class="text-sm text-gray-900">${reg.registrationDate}</div>
                    </td>
                    <td class="py-4 px-4">
                        ${getStatusBadge(reg.status)}
                    </td>
                    <td class="py-4 px-4">
                        <div class="text-sm">
                            ${reg.reviewer ? `<div class="text-gray-900">审核人：${reg.reviewer}</div>` : ''}
                            ${reg.reviewDate ? `<div class="text-gray-500">时间：${reg.reviewDate}</div>` : ''}
                            ${reg.reviewNote ? `<div class="text-gray-500">备注：${reg.reviewNote}</div>` : ''}
                        </div>
                    </td>
                    <td class="py-4 px-4">
                        <div class="flex items-center space-x-2">
                            <button class="text-blue-600 hover:text-blue-800 view-detail" data-id="${reg.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${reg.status === 'pending' ? `
                                <button class="text-green-600 hover:text-green-800 review-item" data-id="${reg.id}">
                                    <i class="fas fa-check"></i>
                                </button>
                            ` : ''}
                            <button class="text-red-600 hover:text-red-800 delete-item" data-id="${reg.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');

            // 绑定事件
            bindTableEvents();
        }

        // 获取状态徽章
        function getStatusBadge(status) {
            const badges = {
                'pending': '<span class="status-badge px-2 py-1 bg-orange-100 text-orange-800 rounded-full">待审核</span>',
                'approved': '<span class="status-badge px-2 py-1 bg-green-100 text-green-800 rounded-full">已通过</span>',
                'rejected': '<span class="status-badge px-2 py-1 bg-red-100 text-red-800 rounded-full">已拒绝</span>',
                'cancelled': '<span class="status-badge px-2 py-1 bg-gray-100 text-gray-800 rounded-full">已取消</span>'
            };
            return badges[status] || '';
        }

        // 绑定表格事件
        function bindTableEvents() {
            // 全选
            document.getElementById('select-all').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('.item-checkbox');
                checkboxes.forEach(cb => {
                    cb.checked = this.checked;
                    if (this.checked) {
                        selectedItems.add(cb.getAttribute('data-id'));
                    } else {
                        selectedItems.delete(cb.getAttribute('data-id'));
                    }
                });
                updateSelectedCount();
            });

            // 单选
            document.querySelectorAll('.item-checkbox').forEach(cb => {
                cb.addEventListener('change', function() {
                    if (this.checked) {
                        selectedItems.add(this.getAttribute('data-id'));
                    } else {
                        selectedItems.delete(this.getAttribute('data-id'));
                    }
                    updateSelectedCount();
                });
            });

            // 查看详情
            document.querySelectorAll('.view-detail').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    showRegistrationDetail(id);
                });
            });

            // 审核
            document.querySelectorAll('.review-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    showReviewModal(id);
                });
            });

            // 删除
            document.querySelectorAll('.delete-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteRegistration(id);
                });
            });
        }

        // 显示报名详情
        function showRegistrationDetail(id) {
            const registration = registrations.find(r => r.id == id);
            if (!registration) return;

            const content = document.getElementById('detail-content');
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">姓名</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.name}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">手机号</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.phone}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">邮箱</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.email}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">年龄</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.formData.age}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">职业</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.formData.occupation}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">经验水平</label>
                            <p class="mt-1 text-sm text-gray-900">${registration.formData.experience}</p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">活动信息</label>
                        <div class="mt-1 p-3 bg-gray-50 rounded-lg">
                            <p class="text-sm text-gray-900">${registration.activity}</p>
                            <p class="text-sm text-gray-500">活动时间：${registration.activityDate}</p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">期望与需求</label>
                        <p class="mt-1 text-sm text-gray-900">${registration.formData.expectations}</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">报名时间</label>
                        <p class="mt-1 text-sm text-gray-900">${registration.registrationDate}</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">审核状态</label>
                        <div class="mt-1">${getStatusBadge(registration.status)}</div>
                    </div>
                    
                    ${registration.reviewer ? `
                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="text-sm font-medium text-gray-700 mb-2">审核信息</h4>
                            <div class="space-y-2">
                                <p class="text-sm"><span class="text-gray-500">审核人：</span>${registration.reviewer}</p>
                                <p class="text-sm"><span class="text-gray-500">审核时间：</span>${registration.reviewDate}</p>
                                <p class="text-sm"><span class="text-gray-500">审核备注：</span>${registration.reviewNote}</p>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;

            document.getElementById('detail-modal').classList.remove('hidden');
        }

        // 显示审核模态框
        function showReviewModal(id) {
            document.getElementById('review-modal').classList.remove('hidden');
            document.getElementById('review-modal').setAttribute('data-id', id);
        }

        // 删除报名
        function deleteRegistration(id) {
            if (confirm('确定要删除这条报名记录吗？')) {
                registrations = registrations.filter(r => r.id != id);
                renderRegistrationTable();
            }
        }

        // 更新选中数量
        function updateSelectedCount() {
            document.getElementById('selected-count').textContent = selectedItems.size;
        }

        // 筛选事件
        document.getElementById('search-input').addEventListener('input', renderRegistrationTable);
        document.getElementById('activity-filter').addEventListener('change', renderRegistrationTable);
        document.getElementById('status-filter').addEventListener('change', renderRegistrationTable);
        document.getElementById('date-filter').addEventListener('change', renderRegistrationTable);

        // 重置筛选
        document.getElementById('reset-filter').addEventListener('click', function() {
            document.getElementById('search-input').value = '';
            document.getElementById('activity-filter').value = '';
            document.getElementById('status-filter').value = '';
            document.getElementById('date-filter').value = '';
            renderRegistrationTable();
        });

        // 刷新数据
        document.getElementById('refresh-data').addEventListener('click', function() {
            renderRegistrationTable();
        });

        // 模态框关闭事件
        document.getElementById('close-detail-modal').addEventListener('click', function() {
            document.getElementById('detail-modal').classList.add('hidden');
        });

        document.getElementById('close-review-modal').addEventListener('click', function() {
            document.getElementById('review-modal').classList.add('hidden');
        });

        document.getElementById('cancel-review').addEventListener('click', function() {
            document.getElementById('review-modal').classList.add('hidden');
        });

        // 确认审核
        document.getElementById('confirm-review').addEventListener('click', function() {
            const modal = document.getElementById('review-modal');
            const id = modal.getAttribute('data-id');
            const result = document.getElementById('review-result').value;
            const note = document.getElementById('review-note').value;

            const registration = registrations.find(r => r.id == id);
            if (registration) {
                registration.status = result;
                registration.reviewer = '管理员';
                registration.reviewDate = new Date().toLocaleString('zh-CN');
                registration.reviewNote = note;
                renderRegistrationTable();
            }

            modal.classList.add('hidden');
        });

        // 批量操作
        document.getElementById('batch-action-btn').addEventListener('click', function() {
            if (selectedItems.size === 0) {
                alert('请先选择要操作的记录');
                return;
            }
            document.getElementById('batch-modal').classList.remove('hidden');
        });

        document.getElementById('close-batch-modal').addEventListener('click', function() {
            document.getElementById('batch-modal').classList.add('hidden');
        });

        document.getElementById('cancel-batch').addEventListener('click', function() {
            document.getElementById('batch-modal').classList.add('hidden');
        });

        document.getElementById('confirm-batch').addEventListener('click', function() {
            const action = document.getElementById('batch-action').value;
            console.log('批量操作:', action, '选中项:', Array.from(selectedItems));
            alert(`已执行批量${action}操作`);
            document.getElementById('batch-modal').classList.add('hidden');
        });

        // 导出数据
        document.getElementById('export-data-btn').addEventListener('click', function() {
            console.log('导出数据');
            alert('数据导出功能开发中...');
        });

        // 初始化
        renderRegistrationTable();
    </script>
</body>
</html>