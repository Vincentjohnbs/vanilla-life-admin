<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>操作日志 - 香草生活后台管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .log-entry:hover {
            background-color: #f9fafb;
        }
        .filter-badge {
            transition: all 0.2s ease;
        }
        .filter-badge:hover {
            transform: translateY(-1px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 侧边栏 -->
    <div id="sidebar" class="fixed left-0 top-0 w-64 h-full bg-white shadow-lg sidebar-transition z-30">
        <!-- Logo -->
        <div class="p-6 border-b">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-leaf text-white text-lg"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-800">香草生活</h1>
                    <p class="text-sm text-gray-500">后台管理系统</p>
                </div>
            </div>
        </div>
        
        <!-- 导航菜单 -->
        <nav class="mt-6">
            <div class="px-4">
                <div class="space-y-2">
                    <a href="#" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg">
                        <i class="fas fa-tachometer-alt w-5 h-5 mr-3"></i>
                        <span>仪表盘</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg">
                        <i class="fas fa-users w-5 h-5 mr-3"></i>
                        <span>用户画像</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg">
                        <i class="fas fa-shield-alt w-5 h-5 mr-3"></i>
                        <span>权限管理</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg">
                        <i class="fas fa-tools w-5 h-5 mr-3"></i>
                        <span>系统维护</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 bg-blue-50 text-blue-600 rounded-lg">
                        <i class="fas fa-history w-5 h-5 mr-3"></i>
                        <span>操作日志</span>
                    </a>
                </div>
            </div>
        </nav>
    </div>

    <!-- 主内容区域 -->
    <div class="ml-64">
        <!-- 顶部导航栏 -->
        <header class="bg-white shadow-sm border-b">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center space-x-4">
                    <button id="sidebarToggle" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div>
                        <h2 class="text-xl font-semibold text-gray-800">操作日志</h2>
                        <p class="text-sm text-gray-500">查看和分析系统操作记录</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell text-xl"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <img src="https://via.placeholder.com/32" alt="Avatar" class="w-8 h-8 rounded-full">
                        <span class="text-sm text-gray-700">管理员</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 页面内容 -->
        <main class="p-6">
            <!-- 统计卡片 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500">今日操作</p>
                            <p class="text-2xl font-bold text-gray-900">1,247</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-mouse-pointer text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600">+12.5%</span>
                        <span class="text-gray-500 ml-1">较昨日</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500">异常操作</p>
                            <p class="text-2xl font-bold text-gray-900">23</p>
                        </div>
                        <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-red-600">+5</span>
                        <span class="text-gray-500 ml-1">较昨日</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500">活跃用户</p>
                            <p class="text-2xl font-bold text-gray-900">156</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-check text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-green-600">+8.2%</span>
                        <span class="text-gray-500 ml-1">较昨日</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500">系统模块</p>
                            <p class="text-2xl font-bold text-gray-900">12</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-cubes text-purple-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <span class="text-gray-500">涉及模块数</span>
                    </div>
                </div>
            </div>

            <!-- 筛选和搜索 -->
            <div class="bg-white rounded-lg shadow mb-6">
                <div class="p-4 border-b">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex flex-wrap items-center gap-4">
                            <div class="relative">
                                <input type="text" id="searchInput" placeholder="搜索操作内容、用户名..." 
                                       class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                            <select id="moduleFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">全部模块</option>
                                <option value="user">用户管理</option>
                                <option value="product">商品管理</option>
                                <option value="order">订单管理</option>
                                <option value="system">系统设置</option>
                            </select>
                            <select id="actionFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">全部操作</option>
                                <option value="create">创建</option>
                                <option value="update">更新</option>
                                <option value="delete">删除</option>
                                <option value="login">登录</option>
                                <option value="logout">登出</option>
                            </select>
                            <select id="levelFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">全部级别</option>
                                <option value="info">信息</option>
                                <option value="warning">警告</option>
                                <option value="error">错误</option>
                                <option value="critical">严重</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="date" id="startDate" class="px-4 py-2 border border-gray-300 rounded-lg">
                            <span class="text-gray-500">至</span>
                            <input type="date" id="endDate" class="px-4 py-2 border border-gray-300 rounded-lg">
                            <button onclick="exportLogs()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                                <i class="fas fa-download mr-2"></i>导出
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 快速筛选标签 -->
                <div class="p-4">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="quickFilter('today')" class="filter-badge px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200">
                            今天
                        </button>
                        <button onclick="quickFilter('yesterday')" class="filter-badge px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm hover:bg-gray-200">
                            昨天
                        </button>
                        <button onclick="quickFilter('week')" class="filter-badge px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm hover:bg-gray-200">
                            本周
                        </button>
                        <button onclick="quickFilter('month')" class="filter-badge px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm hover:bg-gray-200">
                            本月
                        </button>
                        <button onclick="quickFilter('error')" class="filter-badge px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm hover:bg-red-200">
                            错误日志
                        </button>
                        <button onclick="quickFilter('login')" class="filter-badge px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm hover:bg-green-200">
                            登录记录
                        </button>
                    </div>
                </div>
            </div>

            <!-- 标签页导航 -->
            <div class="bg-white rounded-lg shadow">
                <div class="border-b">
                    <nav class="flex space-x-8 px-6" id="logTabs">
                        <button data-tab="list" class="py-4 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                            操作列表
                        </button>
                        <button data-tab="timeline" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                            时间轴视图
                        </button>
                        <button data-tab="statistics" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                            统计分析
                        </button>
                        <button data-tab="realtime" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                            实时监控
                        </button>
                    </nav>
                </div>

                <!-- 操作列表标签页 -->
                <div id="listTab" class="tab-content active">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">时间</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">用户</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">模块</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">级别</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP地址</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">详情</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="logTableBody">
                                <!-- 日志记录将通过JavaScript动态生成 -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 分页 -->
                    <div class="px-6 py-4 border-t">
                        <div class="flex items-center justify-between">
                            <div class="text-sm text-gray-500">
                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">20</span> 条，共 <span class="font-medium">1,247</span> 条记录
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-3 py-2 text-sm bg-gray-100 text-gray-600 rounded hover:bg-gray-200">上一页</button>
                                <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded">1</button>
                                <button class="px-3 py-2 text-sm bg-gray-100 text-gray-600 rounded hover:bg-gray-200">2</button>
                                <button class="px-3 py-2 text-sm bg-gray-100 text-gray-600 rounded hover:bg-gray-200">3</button>
                                <button class="px-3 py-2 text-sm bg-gray-100 text-gray-600 rounded hover:bg-gray-200">下一页</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 时间轴视图标签页 -->
                <div id="timelineTab" class="tab-content p-6">
                    <div class="max-w-4xl mx-auto">
                        <div class="relative" id="timelineContainer">
                            <!-- 时间轴内容将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>

                <!-- 统计分析标签页 -->
                <div id="statisticsTab" class="tab-content p-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold mb-4">操作类型分布</h3>
                            <canvas id="actionTypeChart" width="400" height="300"></canvas>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold mb-4">模块访问统计</h3>
                            <canvas id="moduleAccessChart" width="400" height="300"></canvas>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold mb-4">每日操作趋势</h3>
                            <canvas id="dailyTrendChart" width="400" height="300"></canvas>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold mb-4">用户活跃度</h3>
                            <canvas id="userActivityChart" width="400" height="300"></canvas>
                        </div>
                    </div>
                </div>

                <!-- 实时监控标签页 -->
                <div id="realtimeTab" class="tab-content p-6">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-blue-100">实时在线用户</p>
                                    <p class="text-3xl font-bold" id="onlineUsers">42</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-400 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-users text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-green-100">每分钟操作数</p>
                                    <p class="text-3xl font-bold" id="operationsPerMinute">156</p>
                                </div>
                                <div class="w-12 h-12 bg-green-400 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-tachometer-alt text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-red-500 to-red-600 rounded-lg p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-red-100">异常操作数</p>
                                    <p class="text-3xl font-bold" id="errorCount">3</p>
                                </div>
                                <div class="w-12 h-12 bg-red-400 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-exclamation-triangle text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-4">实时操作流</h3>
                        <div class="h-96 overflow-y-auto bg-gray-900 rounded p-4" id="realtimeLog">
                            <!-- 实时日志将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 日志详情模态框 -->
    <div id="logDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto">
                <div class="p-6 border-b">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold">操作详情</h3>
                        <button onclick="closeLogDetail()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6" id="logDetailContent">
                    <!-- 详情内容将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 侧边栏切换
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('-translate-x-full');
        });

        // 标签页切换
        function initTabs() {
            const tabs = document.querySelectorAll('#logTabs button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // 移除所有活跃状态
                    tabs.forEach(t => {
                        t.classList.remove('border-blue-500', 'text-blue-600');
                        t.classList.add('border-transparent', 'text-gray-500');
                    });
                    
                    // 添加当前标签活跃状态
                    this.classList.remove('border-transparent', 'text-gray-500');
                    this.classList.add('border-blue-500', 'text-blue-600');
                    
                    // 隐藏所有标签页内容
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // 显示目标标签页内容
                    const targetContent = document.getElementById(targetTab + 'Tab');
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                    
                    // 根据标签页初始化相应内容
                    if (targetTab === 'timeline') {
                        renderTimeline();
                    } else if (targetTab === 'statistics') {
                        initStatisticsCharts();
                    } else if (targetTab === 'realtime') {
                        startRealtimeMonitoring();
                    }
                });
            });
        }

        // 渲染日志表格
        function renderLogTable() {
            const logs = [
                {
                    time: '2024-01-20 14:35:22',
                    user: '张三',
                    module: '用户管理',
                    action: '创建用户',
                    level: 'info',
                    ip: '192.168.1.100',
                    details: '创建新用户账号：user001@example.com'
                },
                {
                    time: '2024-01-20 14:32:15',
                    user: '李四',
                    module: '商品管理',
                    action: '更新商品',
                    level: 'info',
                    ip: '192.168.1.101',
                    details: '更新商品信息：香草种子套装'
                },
                {
                    time: '2024-01-20 14:28:43',
                    user: '王五',
                    module: '订单管理',
                    action: '删除订单',
                    level: 'warning',
                    ip: '192.168.1.102',
                    details: '删除异常订单：ORDER-20240120-001'
                },
                {
                    time: '2024-01-20 14:25:18',
                    user: '系统',
                    module: '系统设置',
                    action: '备份数据',
                    level: 'info',
                    ip: '127.0.0.1',
                    details: '执行定时数据备份任务'
                },
                {
                    time: '2024-01-20 14:20:55',
                    user: '赵六',
                    module: '用户管理',
                    action: '登录失败',
                    level: 'error',
                    ip: '192.168.1.103',
                    details: '用户登录失败：密码错误，连续失败3次'
                }
            ];

            const logTableBody = document.getElementById('logTableBody');
            logTableBody.innerHTML = logs.map(log => `
                <tr class="log-entry cursor-pointer" onclick="showLogDetail('${log.time}', '${log.user}', '${log.module}', '${log.action}', '${log.details}')">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${log.time}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${log.user}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${log.module}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${log.action}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs rounded-full ${
                            log.level === 'info' ? 'bg-blue-100 text-blue-800' :
                            log.level === 'warning' ? 'bg-yellow-100 text-yellow-800' :
                            log.level === 'error' ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'
                        }">
                            ${log.level === 'info' ? '信息' : log.level === 'warning' ? '警告' : log.level === 'error' ? '错误' : '未知'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${log.ip}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600 hover:text-blue-900">
                        <i class="fas fa-eye"></i>
                    </td>
                </tr>
            `).join('');
        }

        // 渲染时间轴
        function renderTimeline() {
            const timelineEvents = [
                {
                    time: '14:35',
                    user: '张三',
                    action: '创建用户',
                    module: '用户管理',
                    level: 'info',
                    description: '创建新用户账号：user001@example.com'
                },
                {
                    time: '14:32',
                    user: '李四',
                    action: '更新商品',
                    module: '商品管理',
                    level: 'info',
                    description: '更新商品信息：香草种子套装'
                },
                {
                    time: '14:28',
                    user: '王五',
                    action: '删除订单',
                    module: '订单管理',
                    level: 'warning',
                    description: '删除异常订单：ORDER-20240120-001'
                },
                {
                    time: '14:25',
                    user: '系统',
                    action: '备份数据',
                    module: '系统设置',
                    level: 'info',
                    description: '执行定时数据备份任务'
                }
            ];

            const timelineContainer = document.getElementById('timelineContainer');
            timelineContainer.innerHTML = `
                <div class="absolute left-4 top-0 bottom-0 w-0.5 bg-gray-300"></div>
                ${timelineEvents.map((event, index) => `
                    <div class="relative flex items-start mb-8">
                        <div class="absolute left-2 w-4 h-4 rounded-full border-4 border-white ${
                            event.level === 'info' ? 'bg-blue-500' :
                            event.level === 'warning' ? 'bg-yellow-500' :
                            event.level === 'error' ? 'bg-red-500' : 'bg-gray-500'
                        } z-10"></div>
                        <div class="ml-12 bg-white rounded-lg shadow p-4 flex-1">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm font-medium text-gray-900">${event.time}</span>
                                    <span class="text-sm text-gray-500">•</span>
                                    <span class="text-sm text-gray-600">${event.user}</span>
                                </div>
                                <span class="px-2 py-1 text-xs rounded-full ${
                                    event.level === 'info' ? 'bg-blue-100 text-blue-800' :
                                    event.level === 'warning' ? 'bg-yellow-100 text-yellow-800' :
                                    event.level === 'error' ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'
                                }">
                                    ${event.module}
                                </span>
                            </div>
                            <h4 class="font-medium text-gray-900 mb-1">${event.action}</h4>
                            <p class="text-sm text-gray-600">${event.description}</p>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // 初始化统计图表
        function initStatisticsCharts() {
            // 操作类型分布图
            const actionTypeCtx = document.getElementById('actionTypeChart').getContext('2d');
            new Chart(actionTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['创建', '更新', '删除', '查看', '登录'],
                    datasets: [{
                        data: [25, 35, 15, 20, 5],
                        backgroundColor: [
                            '#3B82F6',
                            '#10B981',
                            '#F59E0B',
                            '#8B5CF6',
                            '#EF4444'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // 模块访问统计图
            const moduleAccessCtx = document.getElementById('moduleAccessChart').getContext('2d');
            new Chart(moduleAccessCtx, {
                type: 'bar',
                data: {
                    labels: ['用户管理', '商品管理', '订单管理', '系统设置', '数据分析'],
                    datasets: [{
                        label: '访问次数',
                        data: [320, 280, 450, 180, 220],
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderColor: 'rgb(59, 130, 246)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // 每日操作趋势图
            const dailyTrendCtx = document.getElementById('dailyTrendChart').getContext('2d');
            new Chart(dailyTrendCtx, {
                type: 'line',
                data: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    datasets: [{
                        label: '操作数量',
                        data: [1200, 1350, 1100, 1400, 1250, 800, 600],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // 用户活跃度图
            const userActivityCtx = document.getElementById('userActivityChart').getContext('2d');
            new Chart(userActivityCtx, {
                type: 'radar',
                data: {
                    labels: ['上午', '中午', '下午', '傍晚', '晚上', '深夜'],
                    datasets: [{
                        label: '活跃度',
                        data: [65, 45, 80, 70, 55, 20],
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        pointBackgroundColor: 'rgb(16, 185, 129)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // 开始实时监控
        function startRealtimeMonitoring() {
            const realtimeLog = document.getElementById('realtimeLog');
            
            // 模拟实时日志
            const logMessages = [
                '[14:35:22] INFO: 用户 张三 登录系统',
                '[14:35:18] INFO: 商品 香草种子套装 库存更新',
                '[14:35:15] WARNING: 用户 李四 尝试访问未授权页面',
                '[14:35:12] INFO: 订单 ORDER-001 状态更新为已发货',
                '[14:35:08] ERROR: 支付接口调用失败，订单 ORDER-002',
                '[14:35:05] INFO: 系统定时任务执行完成'
            ];
            
            let logIndex = 0;
            
            function addRealtimeLog() {
                const message = logMessages[logIndex % logMessages.length];
                const level = message.includes('ERROR') ? 'text-red-400' : 
                             message.includes('WARNING') ? 'text-yellow-400' : 'text-green-400';
                
                const logEntry = document.createElement('div');
                logEntry.className = `${level} font-mono text-sm mb-1`;
                logEntry.textContent = message;
                
                realtimeLog.insertBefore(logEntry, realtimeLog.firstChild);
                
                // 保持最多50条日志
                while (realtimeLog.children.length > 50) {
                    realtimeLog.removeChild(realtimeLog.lastChild);
                }
                
                logIndex++;
            }
            
            // 每2秒添加一条新日志
            setInterval(addRealtimeLog, 2000);
            
            // 更新实时统计数据
            function updateRealtimeStats() {
                document.getElementById('onlineUsers').textContent = Math.floor(Math.random() * 20) + 35;
                document.getElementById('operationsPerMinute').textContent = Math.floor(Math.random() * 50) + 120;
                document.getElementById('errorCount').textContent = Math.floor(Math.random() * 5);
            }
            
            setInterval(updateRealtimeStats, 5000);
        }

        // 显示日志详情
        function showLogDetail(time, user, module, action, details) {
            const modal = document.getElementById('logDetailModal');
            const content = document.getElementById('logDetailContent');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">操作时间</label>
                            <p class="text-sm text-gray-900">${time}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">操作用户</label>
                            <p class="text-sm text-gray-900">${user}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">所属模块</label>
                            <p class="text-sm text-gray-900">${module}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">操作类型</label>
                            <p class="text-sm text-gray-900">${action}</p>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">操作详情</label>
                        <p class="text-sm text-gray-900 bg-gray-50 p-3 rounded">${details}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">请求信息</label>
                        <div class="bg-gray-50 p-3 rounded text-sm">
                            <p><strong>IP地址:</strong> 192.168.1.100</p>
                            <p><strong>用户代理:</strong> Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36</p>
                            <p><strong>请求URL:</strong> /admin/users/create</p>
                            <p><strong>请求方法:</strong> POST</p>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 关闭日志详情
        function closeLogDetail() {
            document.getElementById('logDetailModal').classList.add('hidden');
        }

        // 快速筛选
        function quickFilter(type) {
            console.log('快速筛选:', type);
            // 这里可以实现具体的筛选逻辑
        }

        // 导出日志
        function exportLogs() {
            console.log('导出日志');
            // 这里可以实现导出功能
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            initTabs();
            renderLogTable();
            
            // 设置默认日期
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('endDate').value = today;
            
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 7);
            document.getElementById('startDate').value = yesterday.toISOString().split('T')[0];
        });
    </script>
</body>
</html>